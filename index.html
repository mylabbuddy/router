<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dynamic Single-Page Router</title>
    <!-- Load Tailwind CSS -->
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        /* Custom font import for a clean look */
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap');
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f7f7f7;
            min-height: 100vh;
        }
        /* Style for the active navigation link */
        .active-link {
            background-color: #5b21b6; /* violet-700 */
            color: white;
            font-weight: 600;
        }
    </style>
</head>
<body class="p-4 sm:p-8">

    <div class="max-w-4xl mx-auto bg-white shadow-xl rounded-xl overflow-hidden">
        
        <!-- Header & Navigation -->
        <header class="bg-violet-600 text-white p-4 sm:p-6 shadow-md">
            <h1 class="text-2xl font-bold">Minimalist Router Demo</h1>
            <nav id="main-nav" class="mt-4 flex flex-wrap gap-2 text-sm">
                <!-- Navigation links generated by JS and used for routing -->
            </nav>
        </header>

        <!-- Main Content Area -->
        <main class="p-6 sm:p-8">
            <div class="space-y-6">
                <h2 id="page-title" class="text-3xl font-extrabold text-gray-900"></h2>
                
                <!-- Content generated dynamically by the router -->
                <div id="page-content" class="min-h-[200px] border-t pt-6 border-gray-200">
                    <!-- Dynamic content goes here -->
                </div>
            </div>

            <!-- Deep Link Share Box -->
            <div class="mt-8 p-4 bg-gray-50 border border-gray-200 rounded-lg">
                <p class="text-sm font-semibold text-gray-600 mb-2">Share this page:</p>
                <input id="share-link" type="text" readonly 
                       class="w-full p-2 border border-gray-300 rounded-md bg-white text-sm font-mono text-violet-700 focus:outline-none focus:border-violet-500">
                <button onclick="copyToClipboard()" class="mt-3 w-full sm:w-auto px-4 py-2 bg-violet-500 text-white text-sm font-medium rounded-md hover:bg-violet-600 transition duration-150 ease-in-out shadow-md">
                    Copy Link
                </button>
                <span id="copy-message" class="ml-4 text-xs text-green-600 opacity-0 transition-opacity duration-300">Copied!</span>
            </div>
        </main>
    </div>

    <script>
        // --- DATA SYSTEM (JSON Structure) ---
        const PAGES_DATA = {
            // Standard Pages
            '/': { title: 'üè† Welcome Home', content: 'This is the main dashboard. Click any link in the navigation to change the content instantly. The URL hash will update, allowing for deep linking and sharing.' },
            '/about': { title: 'üåê About This Project', content: 'This project demonstrates a simple, self-contained client-side router. It uses JavaScript\'s `window.location.hash` to manage state, and the `onhashchange` event to detect navigation.' },
            '/contact': { title: 'üìß Get in Touch', content: 'Contact information is dynamic. If you share this link, the recipient will land directly on this contact page without a 404 error.' },
            
            // Dynamic Pages (Placeholder data for products/ID)
            '/products/1': { title: 'üì¶ Product ID: #1', content: 'This is the detail page for Product 1. Notice how the URL includes `/products/1`. You can copy this link and share it.' },
            '/products/2': { title: 'üì¶ Product ID: #2', content: 'This is the detail page for Product 2. This route is handled by the router logic, not a separate HTML file.' },
            '/products/3': { title: 'üì¶ Product ID: #3', content: 'Detail page for Product 3. The data is pulled directly from the local JSON data structure.' },

            // 404 Handler
            '/404': { title: '‚ö†Ô∏è 404 Not Found', content: '<p class="text-red-600 font-bold">Oops! We couldn\'t find the page associated with that route.</p><p>Please check the URL hash and try again, or navigate back to the home page.</p>' }
        };

        // --- CORE ROUTING LOGIC ---

        // 1. Get the current route from the URL hash. Defaults to '/' if hash is empty.
        const getRoute = () => window.location.hash.slice(1) || '/';

        // 2. Main function to render the page content based on the route.
        const renderPage = () => {
            const currentRoute = getRoute();
            let pageData = PAGES_DATA[currentRoute];
            
            // This is where you would implement more complex dynamic matching (if needed).
            // For this simple demo, we rely on the specific keys defined in PAGES_DATA.
            
            // If the route is not found, default to the 404 page.
            if (!pageData) {
                pageData = PAGES_DATA['/404'];
            }

            // Update the UI elements
            const pageTitleEl = document.getElementById('page-title');
            const pageContentEl = document.getElementById('page-content');
            const shareLinkEl = document.getElementById('share-link');

            // Set the content
            pageTitleEl.textContent = pageData.title;
            pageContentEl.innerHTML = `
                <p class="text-sm font-mono text-gray-500 mb-4 bg-gray-100 p-2 inline-block rounded-md">
                    Route: ${currentRoute}
                </p>
                <div class="text-gray-700 leading-relaxed">${pageData.content}</div>
            `;
            
            // Update the share link input field
            shareLinkEl.value = window.location.href;

            // Update the navigation links for visual feedback
            updateNav(currentRoute);
        };

        // 3. Update the navigation links' active state.
        const updateNav = (currentRoute) => {
            const navLinks = document.querySelectorAll('#main-nav a');
            navLinks.forEach(link => {
                // Remove the active class from all links
                link.classList.remove('active-link');
                
                // Add the active class to the link that matches the current route
                // We use link.getAttribute('href').slice(1) to get the path part (e.g., /about)
                if (link.getAttribute('href').slice(1) === currentRoute) {
                    link.classList.add('active-link');
                }
            });
        };

        // 4. Function to generate navigation HTML based on PAGES_DATA
        const generateNav = () => {
            const nav = document.getElementById('main-nav');
            let navHtml = '';

            // Routes to show in the navigation (excluding 404 and dynamic product details)
            const navRoutes = ['/', '/about', '/contact', '/products/1', '/products/2'];

            navRoutes.forEach(route => {
                const data = PAGES_DATA[route];
                if (data) {
                    navHtml += `
                        <a href="#${route}" data-route="${route}"
                           class="nav-link px-4 py-2 rounded-full text-white bg-violet-700 hover:bg-violet-800 transition duration-150 ease-in-out text-xs sm:text-sm">
                            ${data.title.replace(/[\W\d]/g, '').trim()}
                        </a>
                    `;
                }
            });
            nav.innerHTML = navHtml;
        };

        // --- EVENT LISTENERS & INITIALIZATION ---

        // Listen for changes in the URL hash (e.g., when a nav link is clicked)
        window.addEventListener('hashchange', renderPage);

        // Initial setup on page load
        window.addEventListener('load', () => {
            generateNav(); // Create the navigation links
            renderPage();  // Render the initial page content (handles deep linking)
        });

        // --- UTILITY FUNCTIONS ---

        // Copy the current deep link URL to the clipboard
        function copyToClipboard() {
            const linkInput = document.getElementById('share-link');
            const copyMessage = document.getElementById('copy-message');
            
            linkInput.select();
            linkInput.setSelectionRange(0, 99999); // For mobile devices

            try {
                // Use document.execCommand('copy') for better compatibility in iFrames
                document.execCommand('copy');
                
                // Show success message
                copyMessage.classList.add('opacity-100');
                setTimeout(() => {
                    copyMessage.classList.remove('opacity-100');
                }, 1500);
            } catch (err) {
                console.error('Failed to copy text:', err);
                // Fallback for environments where execCommand is restricted
            }
        }
    </script>

</body>
</html>
